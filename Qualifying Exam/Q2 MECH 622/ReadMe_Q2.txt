This was a mess. I first approached this problem using the scalar sailboat model found in Bryson Text. The problem was I could not calculate the derivative of the hamiltonian because the velocity had no closed-form solution, but required a solver to estimate. This is in the Indirect Gradient Method/First Attempt folder.

I vectorialized Bryson's model. This is the bulk of the models found here. I almost got it to work using numerical approaches.

When Dillsaver finally gave me his model (the "bar of soap" model) I solved it in less than an hour. This is the "Kinematic Model" in the likewise-named folder.